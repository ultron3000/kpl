<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>KPL Scorer ‚Äî Match 1 (Titans vs Strikers)</title>
<style>
body{font-family:Inter,Arial,sans-serif;background:#f5f9ff;padding:18px;max-width:1200px;margin:auto;}
.card{background:#fff;border-radius:10px;padding:12px;box-shadow:0 6px 20px rgba(18,38,63,0.06);}
h1{margin-bottom:10px;color:#0b132b;}
button{cursor:pointer;border:0;border-radius:6px;padding:8px 12px;font-weight:600;}
.btnRun{background:#0b69ff;color:#fff;}
.btnExtra{background:#fbbf24;color:#000;}
.btnWicket{background:#ef4444;color:#fff;}
.btnSave{background:#059669;color:#fff;margin-top:10px;}
.status{color:#0b69ff;font-weight:700;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
th,td{padding:6px;border-bottom:1px solid #e5e7eb;text-align:left;font-size:14px;}
pre{background:#0b1220;color:#c8f3ff;padding:10px;border-radius:8px;overflow:auto;}
</style>
</head>
<body>
<h1>üèè KPL Scorer ‚Äî Match 1 (Titans vs Strikers)</h1>

<div class="card">
  <h2>Live Match Status</h2>
  <div id="livePanel">Loading...</div>
</div>

<br>

<div class="card">
  <h2>Scoring Console</h2>

  <label>Innings</label>
  <select id="inningSel">
    <option value="0">1st Innings ‚Äî Titans</option>
    <option value="1">2nd Innings ‚Äî Strikers</option>
  </select>

  <br><br>
  <label>Striker</label>
  <select id="strikerSel"></select>
  <label>Non-Striker</label>
  <select id="nonSel"></select>
  <label>Bowler</label>
  <select id="bowlerSel"></select>

  <br><br>
  <div>
    <button class="btnRun" onclick="ball(0)">0</button>
    <button class="btnRun" onclick="ball(1)">1</button>
    <button class="btnRun" onclick="ball(2)">2</button>
    <button class="btnRun" onclick="ball(3)">3</button>
    <button class="btnRun" onclick="ball(4)">4</button>
    <button class="btnRun" onclick="ball(6)">6</button>
    <button class="btnExtra" onclick="extra('wide')">Wide</button>
    <button class="btnExtra" onclick="extra('noball')">No Ball</button>
    <button class="btnExtra" onclick="extra('bye')">Bye</button>
    <button class="btnExtra" onclick="extra('legbye')">Leg Bye</button>
    <button class="btnWicket" onclick="wicket()">Wicket</button>
  </div>

  <button class="btnSave" onclick="saveData()">Force Save & Push</button>
  <div id="msg" style="margin-top:6px;font-size:13px;color:#065f46;"></div>
</div>

<script>
const ADMIN_PIN="4278";
const BALLS_PER_OVER=6;
const REPO="kpl",BRANCH="main";
let match={
  title:"Titans vs Strikers",
  venue:"KPL Arena 1",
  status:"LIVE",
  currentInnings:0,
  innings:[
    {team:"Titans",total:0,wickets:0,overs:0,balls:0,extras:{wides:0,noballs:0,byes:0,legbyes:0,total:0},battingOrder:[],bowlers:[],fallOfWickets:[],ballsDetailed:[]},
    {team:"Strikers",total:0,wickets:0,overs:0,balls:0,extras:{wides:0,noballs:0,byes:0,legbyes:0,total:0},battingOrder:[],bowlers:[],fallOfWickets:[],ballsDetailed:[]}
  ],
  teams:{
    Titans:["Rohit Sharma","Virat Kohli","Shreyas Iyer","Hardik Pandya","Suryakumar Yadav","Rishabh Pant","Ravindra Jadeja","Bhuvneshwar Kumar","Jasprit Bumrah","Mohammed Shami","Yuzvendra Chahal"],
    Strikers:["Prithvi Shaw","Shikhar Dhawan","KL Rahul","Sanju Samson","Ruturaj Gaikwad","Axar Patel","Deepak Hooda","Mohammed Siraj","Kuldeep Yadav","Arshdeep Singh","Umran Malik"]
  },
  current:{striker:null,nonStriker:null,bowler:null}
};

function $(id){return document.getElementById(id);}
function init(){
  const team=match.currentInnings===0?"Titans":"Strikers";
  const opp=team==="Titans"?"Strikers":"Titans";
  const batList=match.teams[team];
  const bowlList=match.teams[opp];
  $("strikerSel").innerHTML=batList.map(p=>`<option>${p}</option>`).join('');
  $("nonSel").innerHTML=batList.map(p=>`<option>${p}</option>`).join('');
  $("bowlerSel").innerHTML=bowlList.map(p=>`<option>${p}</option>`).join('');
  updatePanel();
}
function updatePanel(){
  const inn=match.innings[match.currentInnings];
  const oversFloat=inn.overs+(inn.balls/BALLS_PER_OVER);
  const rr=oversFloat?(inn.total/oversFloat).toFixed(2):"0.00";
  $("livePanel").innerHTML=`
  <b>${inn.team}</b><br>
  Score: <span class="status">${inn.total}/${inn.wickets}</span> (${inn.overs}.${inn.balls} ov)<br>
  Run Rate: ${rr}<br>
  Striker: ${match.current.striker||'-'} | Non-striker: ${match.current.nonStriker||'-'}<br>
  Bowler: ${match.current.bowler||'-'}
  `;
}
function ball(runs){
  const inn=match.innings[match.currentInnings];
  const striker=$("strikerSel").value;
  const non=$("nonSel").value;
  const bowler=$("bowlerSel").value;
  match.current={striker,nonStriker:non,bowler};
  inn.total+=runs;
  inn.balls++;
  if(inn.balls>=BALLS_PER_OVER){inn.overs++;inn.balls=0;autoPush();}
  updatePanel();
}
function extra(type){
  const inn=match.innings[match.currentInnings];
  inn.extras.total++;inn.total++;
  inn.extras[type+'s']=(inn.extras[type+'s']||0)+1;
  updatePanel();
}
function wicket(){
  const inn=match.innings[match.currentInnings];
  inn.wickets++;
  updatePanel();
}
function saveData(){autoPush(true);}
async function autoPush(force){
  $("msg").innerText="Saving to GitHub...";
  const user=localStorage.getItem("ghUser")||prompt("GitHub username:","ultron3000");
  const token=localStorage.getItem("ghToken")||prompt("GitHub token:");
  localStorage.setItem("ghUser",user);localStorage.setItem("ghToken",token);
  const file="match-1.json";
  const api=`https://api.github.com/repos/${user}/${REPO}/contents/data/${file}`;
  const get=await fetch(api+`?ref=${BRANCH}`,{headers:{Authorization:`token ${token}`}});
  const j=await get.json();const sha=j.sha||null;
  const content=btoa(unescape(encodeURIComponent(JSON.stringify(match,null,2))));
  const body={message:"KPL update",content,branch:BRANCH};if(sha)body.sha=sha;
  const put=await fetch(api,{method:"PUT",headers:{Authorization:`token ${token}`,"Content-Type":"application/json"},body:JSON.stringify(body)});
  $("msg").innerText=put.ok?"Saved to GitHub ‚úÖ":"Error saving";
}
$("inningSel").addEventListener("change",()=>{match.currentInnings=Number($("inningSel").value);init();});
init();
</script>
</body>
</html>
